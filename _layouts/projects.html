---
layout: null
title: Projects
permalink: /projects/
---

<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ page.title | default: "Projects" }} — {{ site.title }}</title>

    <link rel="stylesheet" href="/css/projects.css" />
    {% include mathjax.html %}
  </head>

  <body class="projects-page">
    {% include nav.html %}

    <main class="projects-wrap">
      <header class="projects-hero">
        <div class="hero-kicker">PORTFOLIO</div>
        <h1 class="hero-title">{{ page.title | default: "Projects" }}</h1>
        <p class="hero-subtitle">
          A curated list of missions, simulations, and tools. Minimal, documented, and continuously improved.
        </p>

        <div class="hero-actions">
          <a class="hero-action" href="#tags">Tags</a>
          <a class="hero-action" href="#projects">Projects</a>
        </div>

        <div class="hero-rule"></div>
      </header>

      {% assign projects = site.data.projects %}
      {% if projects == nil %}
        {% assign projects = "" | split: "" %}
      {% endif %}
      {% assign projects_sorted = projects | sort: "year" | reverse %}

      {%- comment -%} Build unique tag list {%- endcomment -%}
      {% assign tag_string = "" %}
      {% for p in projects_sorted %}
        {% if p.tags %}
          {% for t in p.tags %}
            {% assign tag_string = tag_string | append: t | append: "|" %}
          {% endfor %}
        {% endif %}
      {% endfor %}

      {% assign tags_all = tag_string | split: "|" | sort %}
      {% assign tags_unique = "" | split: "" %}
      {% for t in tags_all %}
        {% if t != "" %}
          {% unless tags_unique contains t %}
            {% assign tags_unique = tags_unique | push: t %}
          {% endunless %}
        {% endif %}
      {% endfor %}

      <!-- TAGS -->
      <section id="tags" class="projects-section">
        <div class="section-head">
          <div class="section-title">Tags</div>
          <div class="section-meta"><span id="tagCount">{{ tags_unique | size }}</span></div>
        </div>

        {% if tags_unique == nil or tags_unique.size == 0 %}
          <div class="empty-state">
            <p>No tags yet. Add <code>tags</code> arrays to projects in <code>_data/projects.yml</code>.</p>
          </div>
        {% else %}
          <div class="tag-cloud" id="tagCloud" aria-label="Project tag filters">
            <button class="tag-pill is-active" type="button" data-tag="__all">All</button>
            {% for t in tags_unique %}
              <button class="tag-pill" type="button" data-tag="{{ t | slugify }}">{{ t }}</button>
            {% endfor %}
            <button class="tag-pill tag-clear" type="button" id="clearTags">Clear</button>
          </div>

          <div class="filter-hint" id="filterHint" style="display:none;">
            Filtering by: <span id="filterList"></span>
          </div>
        {% endif %}
      </section>

      <!-- PROJECTS -->
      <section id="projects" class="projects-section">
        <div class="section-head">
          <div class="section-title">All projects</div>
          <div class="section-meta">
            <span id="projectsVisible">{{ projects_sorted | size }}</span>/<span id="projectsTotal">{{ projects_sorted | size }}</span>
          </div>
        </div>

        {% if projects_sorted == nil or projects_sorted.size == 0 %}
          <div class="empty-state">
            <p>No projects loaded yet. Add entries to <code>_data/projects.yml</code>.</p>
          </div>
        {% else %}
          <div class="cards-grid" id="projectsList">
            {% for p in projects_sorted %}
              {% assign tags_attr = "" %}
              {% if p.tags %}
                {% for t in p.tags %}
                  {% assign tags_attr = tags_attr | append: (t | slugify) | append: "|" %}
                {% endfor %}
              {% endif %}

              <article class="card" data-tags="{{ tags_attr }}">
                <div class="card-top">
                  <div class="meta">
                    {% if p.status %}<span class="pill">{{ p.status }}</span>{% endif %}
                    {% if p.year %}<span class="dot">•</span><span class="meta-text">{{ p.year }}</span>{% endif %}
                    {% if p.category %}<span class="dot">•</span><span class="meta-text">{{ p.category }}</span>{% endif %}
                  </div>

                  <h2 class="card-title">{{ p.title }}</h2>
                  {% if p.role %}<div class="card-role">{{ p.role }}</div>{% endif %}
                </div>

                {% if p.summary %}<p class="card-summary">{{ p.summary }}</p>{% endif %}

                {% if p.tags %}
                  <div class="chips">
                    {% for t in p.tags %}
                      <button class="chip js-chip" type="button" data-tag="{{ t | slugify }}">{{ t }}</button>
                    {% endfor %}
                  </div>
                {% endif %}

                {% if p.links %}
                  <div class="card-links">
                    {% for l in p.links %}
                      {% assign u = l.url | to_s %}
                      {% if u contains "://" %}
                        <a class="link" href="{{ l.url }}">{{ l.label }}</a>
                      {% else %}
                        <a class="link" href="{{ l.url | relative_url }}">{{ l.label }}</a>
                      {% endif %}
                    {% endfor %}
                  </div>
                {% endif %}
              </article>
            {% endfor %}
          </div>
        {% endif %}
      </section>

      <footer class="projects-footer">
        <div class="footer-rule"></div>
        <div class="footer-text">Last updated: {{ "now" | date: "%Y-%m-%d" }}</div>
      </footer>
    </main>

    <script>
      (function () {
        const tagCloud = document.getElementById("tagCloud");
        const clearBtn = document.getElementById("clearTags");
        const hint = document.getElementById("filterHint");
        const filterList = document.getElementById("filterList");

        const list = document.getElementById("projectsList");
        const visibleEl = document.getElementById("projectsVisible");
        const totalEl = document.getElementById("projectsTotal");

        if (!tagCloud || !list) return;

        const allBtn = tagCloud.querySelector('[data-tag="__all"]');
        const cards = Array.from(list.querySelectorAll(".card"));
        const total = cards.length;
        if (totalEl) totalEl.textContent = String(total);

        const selected = new Set();

        function getCardTags(card) {
          return new Set(
            (card.getAttribute("data-tags") || "")
              .split("|")
              .map(s => s.trim())
              .filter(Boolean)
          );
        }

        function setPillActive(tag, isActive) {
          const btn = tagCloud.querySelector(`[data-tag="${CSS.escape(tag)}"]`);
          if (!btn) return;
          btn.classList.toggle("is-active", isActive);
        }

        function syncAllButton() {
          if (!allBtn) return;
          allBtn.classList.toggle("is-active", selected.size === 0);
        }

        function renderHint() {
          if (!hint || !filterList) return;
          if (selected.size === 0) {
            hint.style.display = "none";
            filterList.textContent = "";
            return;
          }
          hint.style.display = "";
          filterList.textContent = Array.from(selected).join(", ");
        }

        // OR logic: si hay tags seleccionados -> mostrar si tiene CUALQUIERA de ellos
        function applyFilter() {
          let shown = 0;

          cards.forEach(card => {
            const tags = getCardTags(card);

            let ok = true;
            if (selected.size > 0) {
              ok = false;
              for (const t of selected) {
                if (tags.has(t)) { ok = true; break; }
              }
            }

            card.style.display = ok ? "" : "none";
            if (ok) shown++;
          });

          if (visibleEl) visibleEl.textContent = String(shown);
          syncAllButton();
          renderHint();
        }

        function clearSelection() {
          selected.clear();
          Array.from(tagCloud.querySelectorAll(".tag-pill")).forEach(b => b.classList.remove("is-active"));
          if (allBtn) allBtn.classList.add("is-active");
          applyFilter();
        }

        // Tag pills (robusto: target puede no ser Element)
        tagCloud.addEventListener("click", (e) => {
          const target = e.target;
          const btn = (target && target.closest) ? target.closest("[data-tag]") : null;
          if (!btn) return;

          const tag = (btn.getAttribute("data-tag") || "").trim();
          if (!tag) return;

          if (tag === "__all") {
            clearSelection();
            return;
          }

          if (selected.has(tag)) {
            selected.delete(tag);
            btn.classList.remove("is-active");
          } else {
            selected.add(tag);
            btn.classList.add("is-active");
          }

          applyFilter();
        });

        if (clearBtn) clearBtn.addEventListener("click", clearSelection);

        // Chips inside cards
        list.addEventListener("click", (e) => {
          const target = e.target;
          const chip = (target && target.closest) ? target.closest(".js-chip[data-tag]") : null;
          if (!chip) return;

          e.preventDefault();
          const tag = (chip.getAttribute("data-tag") || "").trim();
          if (!tag) return;

          if (selected.has(tag)) {
            selected.delete(tag);
            setPillActive(tag, false);
          } else {
            selected.add(tag);
            setPillActive(tag, true);
          }

          applyFilter();
        });

        clearSelection();
      })();
    </script>
  </body>
</html>
