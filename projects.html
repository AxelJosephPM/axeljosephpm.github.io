---
layout: null
title: Projects
permalink: /projects/
---

<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ page.title | default: "Projects" }} — {{ site.title }}</title>

    <link rel="stylesheet" href="/css/blog.css" />
    <link rel="stylesheet" href="/css/projects.css" />

    {% include mathjax.html %}
  </head>

  <body class="projects-page">
    {% include nav.html %}

    <main class="projects-wrap">
      <header class="projects-hero">
        <div class="hero-kicker">PORTFOLIO</div>
        <h1 class="hero-title">{{ page.title | default: "Projects" }}</h1>
        <p class="hero-subtitle">
          A curated list of missions, simulations, and tools. Minimal, documented, and continuously improved.
        </p>

        <div class="hero-actions">
          <a class="hero-action" href="#tags">Tags</a>
          <a class="hero-action" href="#all">All</a>
        </div>

        <div class="hero-rule"></div>
      </header>

      {%- comment -%}
      1) Load list from _data/projects.yml (cards data)
      2) Build a lookup from site pages under /projects/ so each card can link to its page
      {%- endcomment -%}

      {% assign projects = site.data.projects %}
      {% if projects == nil %}
        {% assign projects = "" | split: "" %}
      {% endif %}
      {% assign projects_sorted = projects | sort: "year" | reverse %}

      {%- comment -%}
      Build map: project "slug" -> url
      We will match by p.slug in projects.yml to the page's basename.
      Example: projects/s-art.md => slug "s-art"
      {%- endcomment -%}
      {% assign project_pages = site.pages | where_exp: "pg", "pg.path contains 'projects/'" %}
      {% assign url_map_string = "" %}
      {% for pg in project_pages %}
        {% assign base = pg.path | split: "/" | last | replace: ".md", "" | replace: ".html", "" %}
        {% assign url_map_string = url_map_string | append: base | append: "=>" | append: pg.url | append: "||" %}
      {% endfor %}

      {%- comment -%}
      Build unique tag list from projects_sorted
      {%- endcomment -%}
      {% assign tag_string = "" %}
      {% for pr in projects_sorted %}
        {% if pr.tags %}
          {% for t in pr.tags %}
            {% assign tag_string = tag_string | append: t | append: "|" %}
          {% endfor %}
        {% endif %}
      {% endfor %}
      {% assign tags_all = tag_string | split: "|" | sort %}
      {% assign tags_unique = "" | split: "" %}
      {% for t in tags_all %}
        {% if t != "" %}
          {% assign norm = t | downcase | strip %}
          {% if tags_unique contains norm %}
          {% else %}
            {% assign tags_unique = tags_unique | push: norm %}
          {% endif %}
        {% endif %}
      {% endfor %}

      <!-- TAGS -->
      <section id="tags" class="projects-section">
        <div class="section-head">
          <div class="section-title">Tags</div>
          <div class="section-meta"><span id="tagCount">{{ tags_unique | size }}</span></div>
        </div>

        {% if tags_unique == nil or tags_unique.size == 0 %}
          <div class="empty-state">
            <p>No tags yet. Add <code>tags</code> arrays to projects in <code>_data/projects.yml</code>.</p>
          </div>
        {% else %}
          <div class="tag-cloud" id="tagCloud" aria-label="Project tag filters">
            <button class="tag-pill is-active" type="button" data-tag="__all">All</button>
            {% for t in tags_unique %}
              <button class="tag-pill" type="button" data-tag="{{ t }}">{{ t }}</button>
            {% endfor %}
            <button class="tag-pill tag-clear" type="button" id="clearTags">Clear</button>
          </div>

          <div class="filter-hint" id="filterHint" style="display:none;">
            Filtering by: <span id="filterList"></span>
          </div>
        {% endif %}
      </section>

      <!-- ALL PROJECTS -->
      <section id="all" class="projects-section">
        <div class="section-head">
          <div class="section-title">All projects</div>
          <div class="section-meta">
            <span id="projectsVisible">{{ projects_sorted | size }}</span>/<span id="projectsTotal">{{ projects_sorted | size }}</span>
          </div>
        </div>

        {% if projects_sorted == nil or projects_sorted.size == 0 %}
          <div class="empty-state">
            <p>No projects loaded yet. Create <code>_data/projects.yml</code> and add entries.</p>
          </div>
        {% else %}
          <div class="cards-grid" id="projectsList">
            {% for pr in projects_sorted %}

              {%- comment -%}
              Resolve project page URL:
              expects pr.slug in projects.yml matching filename in /projects/.
              Example: pr.slug: "s-art" => /projects/s-art/
              {%- endcomment -%}
              {% assign project_url = "" %}
              {% if pr.slug %}
                {% assign needle = pr.slug | downcase | strip | append: "=>" %}
                {% assign parts = url_map_string | split: "||" %}
                {% for row in parts %}
                  {% if row contains needle %}
                    {% assign project_url = row | split: "=>" | last %}
                  {% endif %}
                {% endfor %}
              {% endif %}
              {% if project_url == "" and pr.url %}
                {%- comment -%} fallback if you already store url in projects.yml {%- endcomment -%}
                {% assign project_url = pr.url %}
              {% endif %}

              {%- comment -%}
              Normalize tags into data-tags: lower + strip, separated by |
              {%- endcomment -%}
              {% assign tags_attr = "" %}
              {% if pr.tags %}
                {% for t in pr.tags %}
                  {% assign tags_attr = tags_attr | append: (t | downcase | strip) | append: "|" %}
                {% endfor %}
              {% endif %}

              <article class="card" data-tags="{{ tags_attr }}" data-url="{{ project_url }}">
                <div class="card-top">
                  <div class="meta">
                    {% if pr.status %}<span class="pill">{{ pr.status }}</span>{% endif %}
                    {% if pr.year %}<span class="dot">•</span><span class="meta-text">{{ pr.year }}</span>{% endif %}
                    {% if pr.category %}<span class="dot">•</span><span class="meta-text">{{ pr.category }}</span>{% endif %}
                  </div>

                  <h2 class="card-title">
                    {% if project_url != "" %}
                      <a class="card-title-link" href="{{ project_url }}">{{ pr.title }}</a>
                    {% else %}
                      {{ pr.title }}
                    {% endif %}
                  </h2>

                  {% if pr.role %}
                    <div class="card-role">{{ pr.role }}</div>
                  {% endif %}
                </div>

                {% if pr.image %}
                  <div class="thumb">
                    <img src="{{ pr.image }}" alt="{{ pr.title }} thumbnail" loading="lazy" />
                  </div>
                {% endif %}

                {% if pr.summary %}
                  <p class="card-summary">{{ pr.summary }}</p>
                {% endif %}

                {% if pr.tags %}
                  <div class="chips">
                    {% for t in pr.tags %}
                      <button class="chip chip-link" type="button" data-tag="{{ t | downcase | strip }}">{{ t }}</button>
                    {% endfor %}
                  </div>
                {% endif %}

                <div class="card-links">
                  {% if project_url != "" %}
                    <a class="link" href="{{ project_url }}">READ</a>
                  {% endif %}

                  {% if pr.links %}
                    {% for l in pr.links %}
                      <a class="link" href="{{ l.url }}">{{ l.label }}</a>
                    {% endfor %}
                  {% endif %}
                </div>
              </article>
            {% endfor %}
          </div>
        {% endif %}
      </section>

      <footer class="projects-footer">
        <div class="footer-rule"></div>
        <div class="footer-text">Last updated: {{ "now" | date: "%Y-%m-%d" }}</div>
      </footer>
    </main>

    <script>
      (function () {
        const tagCloud = document.getElementById("tagCloud");
        const clearBtn = document.getElementById("clearTags");
        const hint = document.getElementById("filterHint");
        const filterList = document.getElementById("filterList");

        const list = document.getElementById("projectsList");
        const visibleEl = document.getElementById("projectsVisible");
        const totalEl = document.getElementById("projectsTotal");

        if (!tagCloud || !list) return;

        const tagButtons = Array.from(tagCloud.querySelectorAll("[data-tag]"));
        const allBtn = tagCloud.querySelector('[data-tag="__all"]');
        const cards = Array.from(list.querySelectorAll(".card"));

        const total = cards.length;
        if (totalEl) totalEl.textContent = String(total);

        // ✅ OR logic: show cards that match any selected tag
        const selected = new Set();

        function getCardTags(card) {
          const raw = (card.getAttribute("data-tags") || "")
            .split("|")
            .map(s => s.trim().toLowerCase())
            .filter(Boolean);
          return new Set(raw);
        }

        function setButtonActive(tag, isActive) {
          const btn = tagCloud.querySelector(`[data-tag="${CSS.escape(tag)}"]`);
          if (!btn) return;
          btn.classList.toggle("is-active", isActive);
        }

        function syncAllButton() {
          const hasFilters = selected.size > 0;
          if (allBtn) allBtn.classList.toggle("is-active", !hasFilters);
        }

        function renderHint() {
          if (!hint || !filterList) return;
          if (selected.size === 0) {
            hint.style.display = "none";
            filterList.textContent = "";
            return;
          }
          hint.style.display = "";
          filterList.textContent = Array.from(selected).join(", ");
        }

        function applyFilter() {
          let shown = 0;

          cards.forEach(card => {
            const tags = getCardTags(card);

            let ok = true;
            if (selected.size > 0) {
              ok = false;
              for (const t of selected) {
                if (tags.has(t)) { ok = true; break; }
              }
            }

            card.style.display = ok ? "" : "none";
            if (ok) shown++;
          });

          if (visibleEl) visibleEl.textContent = String(shown);
          syncAllButton();
          renderHint();
        }

        function clearSelection() {
          selected.clear();
          tagButtons.forEach(btn => btn.classList.remove("is-active"));
          if (allBtn) allBtn.classList.add("is-active");
          applyFilter();
        }

        // Top tag pills
        tagCloud.addEventListener("click", (e) => {
          const btn = e.target.closest("[data-tag]");
          if (!btn) return;

          const tag = (btn.getAttribute("data-tag") || "").toLowerCase().trim();
          if (!tag) return;

          if (tag === "__all") { clearSelection(); return; }

          if (selected.has(tag)) {
            selected.delete(tag);
            btn.classList.remove("is-active");
          } else {
            selected.add(tag);
            btn.classList.add("is-active");
          }

          applyFilter();
        });

        if (clearBtn) clearBtn.addEventListener("click", clearSelection);

        // Chips inside cards toggle filters too
        list.addEventListener("click", (e) => {
          const chip = e.target.closest(".chip-link[data-tag]");
          if (!chip) return;
          e.preventDefault();

          const tag = (chip.getAttribute("data-tag") || "").toLowerCase().trim();
          if (!tag) return;

          if (selected.has(tag)) {
            selected.delete(tag);
            setButtonActive(tag, false);
          } else {
            selected.add(tag);
            setButtonActive(tag, true);
          }

          applyFilter();
        });

        clearSelection();
      })();
    </script>
  </body>
</html>
